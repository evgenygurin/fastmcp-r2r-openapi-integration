# R2R MCP Server

## üéØ –û–±–∑–æ—Ä –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

FastMCP-based MCP —Å–µ—Ä–≤–µ—Ä –¥–ª—è R2R API, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—â–∏–π Tools –∏ Resources –∏–∑ OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫—É—é –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ endpoints.

**–ö–ª—é—á–µ–≤—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è:**
- **–ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑ OpenAPI**: –ú–∏–Ω–∏–º—É–º —Ä—É—á–Ω–æ–≥–æ –∫–æ–¥–∞, –º–∞–∫—Å–∏–º—É–º –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç–∏
- **–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–µ route maps**: GET ‚Üí Resources, POST/PUT/DELETE ‚Üí Tools
- **Stateless design**: –í—Å—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ httpx.AsyncClient
- **Dual transport**: stdio –¥–ª—è Claude Desktop, HTTP –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- **Experimental parser support**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ OpenAPI –ø–∞—Ä—Å–µ—Ä–∞ —Å fallback –Ω–∞ legacy
- **Performance optimizations**: –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ debug logging

## üõ†Ô∏è –ö–æ–º–∞–Ω–¥—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
make install dev

# 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Å –≤–∞—à–∏–º–∏ –∫—Ä–µ–¥–µ–Ω—à–∞–ª–∞–º–∏

# 3. –ó–∞–ø—É—Å–∫
make run              # stdio —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç
make run-http         # HTTP –Ω–∞ :8000 –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
```

### –†–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º
make lint

# –ê–≤—Ç–æ–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
make fix

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
make update-spec
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Claude Desktop

```json
{
  "mcpServers": {
    "r2r": {
      "command": "uv",
      "args": [
        "--directory",
        "/path/to/fastmcp-r2r-openapi-integration",
        "run",
        "python",
        "-m",
        "src.server"
      ],
      "env": {
        "R2R_BASE_URL": "http://localhost:7272",
        "R2R_API_KEY": "–≤–∞—à_–∫–ª—é—á"
      }
    }
  }
}
```

### Performance Optimizations

–ü—Ä–æ–µ–∫—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–ø—Ü–∏–π –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

**DEBUG_LOGGING** - –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:
```bash
# –í .env –¥–æ–±–∞–≤—å—Ç–µ:
DEBUG_LOGGING=true

# –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
# - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–º OpenAPI –ø–∞—Ä—Å–µ—Ä–µ
# - –î–µ—Ç–∞–ª–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
# - OpenAPI compliance –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
```

**ENABLE_CACHING** - –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤ API:
```bash
# –í .env –¥–æ–±–∞–≤—å—Ç–µ:
ENABLE_CACHING=true

# –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
# - –£—Å–∫–æ—Ä—è–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
# - –°–Ω–∏–∂–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ R2R API
# - –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è read-heavy workloads
```

**Experimental OpenAPI Parser**:
–°–µ—Ä–≤–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—ã—Ç–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–µ—Ä —Å fallback –Ω–∞ legacy:
- ‚úÖ 100-200ms –±—ã—Å—Ç—Ä–µ–µ —Å—Ç–∞—Ä—Ç (–Ω–µ—Ç code generation)
- ‚úÖ Stateless request building —á–µ—Ä–µ–∑ openapi-core
- ‚úÖ –õ—É—á—à–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å serverless (FastMCP Cloud)
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ OpenAPI 3.0/3.1

–ü–∞—Ä—Å–µ—Ä –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞.

## üìö –ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏

### Route Maps: –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è

FastMCP –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å, –∫–∞–∫ OpenAPI endpoints –ø—Ä–µ–æ–±—Ä–∞–∑—É—é—Ç—Å—è –≤ MCP –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

**MCPType.RESOURCE_TEMPLATE** - –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã (GET —Å path params):
```python
RouteMap(
    methods=["GET"],
    pattern=r"^/v3/documents/\{id\}$",
    mcp_type=MCPType.RESOURCE_TEMPLATE,
)
```

**MCPType.RESOURCE** - —Å—Ç–∞—Ç–∏—á–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã (GET —Å–ø–∏—Å–∫–æ–≤):
```python
RouteMap(
    methods=["GET"],
    pattern=r"^/v3/documents$",
    mcp_type=MCPType.RESOURCE,
)
```

**MCPType.TOOL** - –æ–ø–µ—Ä–∞—Ü–∏–∏ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ (POST/PUT/DELETE):
```python
RouteMap(
    methods=["POST"],
    pattern=r".*/search$",
    mcp_type=MCPType.TOOL,
)
```

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ httpx.AsyncClient headers:

```python
headers = {"Authorization": f"Bearer {R2R_API_KEY}"}
client = httpx.AsyncClient(
    base_url=R2R_BASE_URL,
    headers=headers,
    timeout=R2R_TIMEOUT,
)
```

–ù–ò–ö–û–ì–î–ê –Ω–µ —Ö–∞—Ä–¥–∫–æ–¥–∏—Ç—å API –∫–ª—é—á–∏ –≤ –∫–æ–¥–µ - —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ .env!

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```text
src/server.py         - –û—Å–Ω–æ–≤–Ω–æ–π MCP —Å–µ—Ä–≤–µ—Ä —Å route maps
openapi.json          - R2R OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è (–∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)
.env                  - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–Ω–µ –≤ git!)
pyproject.toml        - uv –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ + ruff config
```

## ‚õîÔ∏è –ó–∞–ø—Ä–µ—â–µ–Ω–Ω—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

- ‚ùå –ù–ò–ö–û–ì–î–ê –Ω–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å openapi.json –≤—Ä—É—á–Ω—É—é - —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ `make update-spec`
- ‚ùå –ù–ï —Ö–∞—Ä–¥–∫–æ–¥–∏—Ç—å credentials - —Ç–æ–ª—å–∫–æ .env
- ‚ùå –ù–ï —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ä—É—á–Ω—ã–µ tool wrappers –µ—Å–ª–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å from_openapi
- ‚ùå –ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å pip - –¢–û–õ–¨–ö–û uv –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
- ‚ùå –ù–ï –∫–æ–º–º–∏—Ç–∏—Ç—å .env —Ñ–∞–π–ª—ã

## üîÑ Workflow –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è API

–ö–æ–≥–¥–∞ R2R API –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è:

```bash
# 1. –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é
make update-spec

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å route maps –≤ src/server.py
#    –í–æ–∑–º–æ–∂–Ω–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ –Ω–æ–≤—ã–µ endpoints

# 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
make run-http
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á–µ—Ä–µ–∑ MCP Inspector –∏–ª–∏ curl

# 4. –õ–∏–Ω—Ç–∏–Ω–≥
make fix && make lint
```

## üìñ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [FastMCP OpenAPI Integration](https://gofastmcp.com/integrations/openapi)
- [R2R Documentation](https://r2r-docs.sciphi.ai/)
- [MCP Specification](https://modelcontextprotocol.io)
